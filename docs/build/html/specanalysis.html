

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The SpecAnalysis Module &mdash; Sculptor 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Masks &amp; Models Module" href="masksmodels.html" />
    <link rel="prev" title="The SpecFit Module" href="specfit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sculptor
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">The Sculptor GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_fit.html">Spectral fitting with the Sculptor GUI</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="speconed_demonstration.html">An introduction to the SpecOneD class</a></li>
<li class="toctree-l1"><a class="reference internal" href="speconed_demonstration.html#The-PassBand-class">The PassBand class</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum_preparation.html">Preparing a composite spectrum for Sculptor modeling using the SpecOneD class</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_1.html">Scripting Sculptor 01 - Modelling the example spectrum in a script</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_2.html">Scripting Sculptor 02 - Analysing model fits with SpecAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_3.html">Scripting Sculptor 03 - Fitting and Analzying models using MCMC</a></li>
</ul>
<p class="caption"><span class="caption-text">Module documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="speconed.html">The SpecOneD Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specmodel.html">The SpecModel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specfit.html">The SpecFit Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The SpecAnalysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="masksmodels.html">The Masks &amp; Models Module</a></li>
</ul>
<p class="caption"><span class="caption-text">Extensions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qso_extension.html">The QSO-Extension Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_extension.html">Example extension Module</a></li>
</ul>
<p class="caption"><span class="caption-text">License:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sculptor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>The SpecAnalysis Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/specanalysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-sculptor.specanalysis">
<span id="the-specanalysis-module"></span><h1>The SpecAnalysis Module<a class="headerlink" href="#module-sculptor.specanalysis" title="Permalink to this headline">¶</a></h1>
<p>The SpecAnalysis module provides a range of functions for spectral analsysis
in the context of the Sculptor packages SpecOneD, SpecFit, and SpecModel
classes.</p>
<dl class="py function">
<dt id="sculptor.specanalysis.analyze_continuum">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">analyze_continuum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rest_frame_wavelengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.analyze_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate measurements of the continuum at a range of specified
wavelengths for a spectral fit (SpecFit object).</p>
<p>At present this analysis assumes that the spectra are in the following
units:
flux density - erg/s/cm^2/AA
dispersion - AA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>specfit</strong> (<a class="reference internal" href="specfit.html#sculptor.specfit.SpecFit" title="sculptor.specfit.SpecFit"><em>sculptor.specfit.SpecFit</em></a>) – SpecFit class object to extract the model flux from</p></li>
<li><p><strong>model_names</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – List of model names to create the emission feature flux
from.</p></li>
<li><p><strong>rest_frame_wavelengths</strong> (<em>list</em><em>(</em><em>float</em><em>)</em>) – Rest-frame wavelength of the emission feature</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology for calculation of absolute properties</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the object. This keyword argument defaults
to ‘None’, in which case the redshift from the SpecFit object is used.</p></li>
<li><p><strong>dispersion</strong> (<em>np.array</em>) – This keyword argument allows to input a dispersion
axis (e.g., wavelengths) for which the model fluxes are calculated. The
value defaults to ‘None’, in which case the dispersion from the SpecFit
spectrum is being used.</p></li>
<li><p><strong>cont_meas</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>width</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Window width in dispersion units to calculate the average
flux density in.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with measurement results (with units)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.analyze_emission_feature">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">analyze_emission_feature</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rest_frame_wavelength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_model_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emfeat_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spline'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.analyze_emission_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate measurements of an emission feature for a spectral fit (
SpecFit object).</p>
<p>At present this analysis assumes that the spectra are in the following
units:
flux density - erg/s/cm^2/AA
dispersion - AA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>specfit</strong> (<a class="reference internal" href="specfit.html#sculptor.specfit.SpecFit" title="sculptor.specfit.SpecFit"><em>sculptor.specfit.SpecFit</em></a>) – SpecFit class object to extract the model flux from</p></li>
<li><p><strong>feature_name</strong> (<em>string</em>) – Name of the emission feature, which will be used to
name the resulting measurements in the output dictionary.</p></li>
<li><p><strong>model_names</strong> (<em>list</em>) – List of model names to create the emission feature flux
from.</p></li>
<li><p><strong>rest_frame_wavelength</strong> (<em>float</em>) – Rest-frame wavelength of the emission feature</p></li>
<li><p><strong>cont_model_names</strong> (<em>list</em>) – List of model names to create the continuum
flux model from. The continuum spectrum is for example used in the
calculation of some emission feature properties (e.g. equivalent width).</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the object. This keyword argument defaults
to ‘None’, in which case the redshift from the SpecFit object is used.</p></li>
<li><p><strong>dispersion</strong> (<em>np.array</em>) – This keyword argument allows to input a dispersion
axis (e.g., wavelengths) for which the model fluxes are calculated. The
value defaults to ‘None’, in which case the dispersion from the SpecFit
spectrum is being used.</p></li>
<li><p><strong>emfeat_meas</strong> (<em>list</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>disp_range</strong> (<em>list</em>) – 2 element list holding the lower and upper dispersion
boundaries for the integration</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology class</em>) – Cosmology for calculating luminosities</p></li>
<li><p><strong>fwhm_method</strong> (<em>string</em>) – Method to use for calculating the FWHM. Possible
values are ‘sign’ or ‘spline’ (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with measurement results (with units)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.analyze_mcmc_results">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">analyze_mcmc_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foldername</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_feature_dictlist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emfeat_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concatenate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.analyze_mcmc_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze MCMC model fit results of specified continuum/feature models.</p>
<p>Results will be written to an enhanced csv file in the same folder,
where the MCMC flat chain data resides.</p>
<p><strong>Important:</strong> Only model functions that are sampled together can be     analyzed together. This means that only model functions from ONE     SpecModel can also be analyzed together.     Additionally, only model functions for which all variable parameters     have sampled by the MCMC fit are analyzed.</p>
<p>The following parameters should be specified in the <em>continuum_listdict</em>:</p>
<ul class="simple">
<li><p>‘model_names’ - list of model function prefixes for the full continuum         model</p></li>
<li><p>‘rest_frame_wavelengths’ - list of rest-frame wavelengths (float) for         which fluxes, luminosities and magnitudes should be calculated</p></li>
</ul>
<p>The other arguments for the <em>SpecAnalysis.analyze_continuum</em> are provided         to the MCMC analysis function separately.</p>
<p>The following parameters should be specified in the         <em>emission_feature_listdict</em>:</p>
<ul class="simple">
<li><p>‘feature_name’ - name of the emission feature, which will be used to         name the resulting measurements in the output file.</p></li>
<li><p>‘model_names’ - list of model names to create the emission feature model         flux from.</p></li>
<li><p>‘rest_frame_wavelength’ - rest-frame wavelength of the emission feature.</p></li>
</ul>
<p>Additionally, one can specify:</p>
<ul class="simple">
<li><p>‘disp_range’ - 2 element list holding the lower and upper dispersion         boundaries flux density integration.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>foldername</strong> (<em>string</em>) – Path to the folder with the MCMC flat chain hdf5 files.</p></li>
<li><p><strong>specfit</strong> (<a class="reference internal" href="specfit.html#sculptor.specfit.SpecFit" title="sculptor.specfit.SpecFit"><em>sculptor.specfit.SpecFit</em></a>) – Sculptor model fit (SpecFit object) containing the
information about the science spectrum, the SpecModels and parameters.</p></li>
<li><p><strong>continuum_dict</strong> (<em>dictionary</em>) – The <em>continuum_listdict</em> holds the arguments for
the <em>SpecAnalysis.analyze_continuum</em> function that will be called by
this procedure.</p></li>
<li><p><strong>emission_feature_dictlist</strong> (<em>list of dictionary</em>) – The <em>emission_feature_listdict</em> hold the
arguments for the <em>SpecAnalysis.analyze_emission_feature</em> functions that
will be called by this procedure.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology for calculation of absolute properties</p></li>
<li><p><strong>emfeat_meas</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>cont_meas</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>dispersion</strong> (<em>np.array</em>) – This keyword argument allows to input a dispersion
axis (e.g., wavelengths) for which the model fluxes are calculated. The
value defaults to ‘None’, in which case the dispersion from the SpecFit
spectrum is being used.</p></li>
<li><p><strong>width</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Window width in dispersion units to calculate the average
flux density in.</p></li>
<li><p><strong>concatenate</strong> (<em>bool</em>) – Boolean to indicate whether the MCMC flat chain and
the analysis results should be concatenated before written to file.
(False = Only writes analysis results to file; True = Writes analysis
results and MCMC flat chain parameter values to file)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.analyze_resampled_results">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">analyze_resampled_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foldername</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampled_df_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_feature_dictlist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emfeat_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_meas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concatenate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.analyze_resampled_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze resampled model fit results for all specified continuum and
feature models.</p>
<p>Results will be written to an enhanced csv file in the same folder,
where the resampled raw data resides.</p>
<p>The following parameters should be specified in the <em>continuum_listdict</em>:</p>
<ul class="simple">
<li><p>‘model_names’ - list of model function prefixes for the full continuum         model</p></li>
<li><p>‘rest_frame_wavelengths’ - list of rest-frame wavelengths (float) for         which fluxes, luminosities and magnitudes should be calculated</p></li>
</ul>
<p>The other arguments for the <em>SpecAnalysis.analyze_continuum</em> are provided         to the MCMC analysis function separately.</p>
<p>The following parameters should be specified in the         <em>emission_feature_listdict</em>:</p>
<ul class="simple">
<li><p>‘feature_name’ - name of the emission feature, which will be used to         name the resulting measurements in the output file.</p></li>
<li><p>‘model_names’ - list of model names to create the emission feature model         flux from.</p></li>
<li><p>‘rest_frame_wavelength’ - rest-frame wavelength of the emission feature.</p></li>
</ul>
<p>Additionally, one can specify:</p>
<ul class="simple">
<li><p>‘disp_range’ - 2 element list holding the lower and upper dispersion         boundaries flux density integration.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>specfit</strong> (<a class="reference internal" href="specfit.html#sculptor.specfit.SpecFit" title="sculptor.specfit.SpecFit"><em>sculptor.specfit.SpecFit</em></a>) – Sculptor model fit (SpecFit object) containing the
information about the science spectrum, the SpecModels and parameters.</p></li>
<li><p><strong>foldername</strong> (<em>string</em>) – Path to the folder with the resampled raw hdf5 file.</p></li>
<li><p><strong>resampled_df_name</strong> (<em>str</em>) – Filename of the resampled raw DataFrame saved
in hdf5 format.</p></li>
<li><p><strong>continuum_dict</strong> (<em>dictionary</em>) – The <em>continuum_listdict</em> holds the arguments for
the <em>SpecAnalysis.analyze_continuum</em> function that will be called by
this procedure.</p></li>
<li><p><strong>emission_feature_dictlist</strong> (<em>list of dictionary</em>) – The <em>emission_feature_listdict</em> hold the
arguments for the <em>SpecAnalysis.analyze_emission_feature</em> functions that
will be called by this procedure.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology for calculation of absolute properties</p></li>
<li><p><strong>emfeat_meas</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>cont_meas</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – This keyword argument allows to specify the list of
emission feature measurements.
Currently possible measurements are [‘peak_fluxden’, ‘peak_redsh’, ‘EW’,
‘FWHM’, ‘flux’]. The value defaults to ‘None’ in which all measurements
are calculated</p></li>
<li><p><strong>dispersion</strong> (<em>np.array</em>) – This keyword argument allows to input a dispersion
axis (e.g., wavelengths) for which the model fluxes are calculated. The
value defaults to ‘None’, in which case the dispersion from the SpecFit
spectrum is being used.</p></li>
<li><p><strong>width</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Window width in dispersion units to calculate the average
flux density in.</p></li>
<li><p><strong>concatenate</strong> (<em>bool</em>) – Boolean to indicate whether the MCMC flat chain and
the analysis results should be concatenated before written to file.
(False = Only writes analysis results to file; True = Writes analysis
results and MCMC flat chain parameter values to file)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.build_model_flux">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">build_model_flux</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.build_model_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the model flux from a specified list of models that exist in the
SpecModels of the SpecFit object.</p>
<p>The dispersion axis for the model flux can be specified as a keyword
argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>specfit</strong> (<a class="reference internal" href="specfit.html#sculptor.specfit.SpecFit" title="sculptor.specfit.SpecFit"><em>sculptor.specfit.SpecFit</em></a>) – SpecFit class object to extract the model flux from</p></li>
<li><p><strong>model_list</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – List of model names to create the model flux from. The
models must be exist in the SpecModel objects inside the SpecFit object.</p></li>
<li><p><strong>dispersion</strong> (<em>np.array</em>) – New dispersion to create the model flux for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SpecOneD objects with the model flux</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sod.SpecOneD</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_absolute_mag_from_apparent_mag">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_absolute_mag_from_apparent_mag</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">appmag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kcorrection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_absolute_mag_from_apparent_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the absolute magnitude from the apparent magnitude using a
power law k-correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>appmag</strong> (<em>float</em>) – Apparent AB magnitude</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology as an astropy Cosmology object.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the source.</p></li>
<li><p><strong>kcorrection</strong> (<em>bool</em>) – Boolean to indicate whether the magnitude should be
k-corrected assuming a power law spectrum. This keyword argument
defaults to ‘True’.</p></li>
<li><p><strong>a_nu</strong> (<em>float</em>) – Power law slope as a function of frequency for the
k-correction. This defaults to ‘0’, appropriate for monochromatic
measurements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absolute AB magnitude (monochromatic)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_absolute_mag_from_fluxden">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_absolute_mag_from_fluxden</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kcorrection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_absolute_mag_from_fluxden" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the absolute AB magnitude from the monochromatic flux density
at a given dispersion value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fluxden</strong> (<em>astropy.units.Quantity</em>) – Monochromatic flux density at a given wavelength.</p></li>
<li><p><strong>dispersion</strong> (<em>float</em>) – Dispersion value (usually in wavelength).</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology as an astropy Cosmology object.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the source.</p></li>
<li><p><strong>kcorrection</strong> (<em>bool</em>) – Boolean to indicate whether the magnitude should be
k-corrected assuming a power law spectrum. This keyword argument
defaults to ‘True’.</p></li>
<li><p><strong>a_nu</strong> (<em>float</em>) – Power law slope as a function of frequency for the
k-correction. This defaults to ‘0’, appropriate for monochromatic
measurements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absolute AB magnitude (monochromatic)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_absolute_mag_from_monochromatic_luminosity">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_absolute_mag_from_monochromatic_luminosity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_wav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_absolute_mag_from_monochromatic_luminosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the absolute monochromatic magnitude from the monochromatic
luminosity per wavelegnth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_wav</strong> (<em>astropy.units.Quantity</em>) – Monochromatic luminosity per wavelength</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Wavelength of the monochromatic luminosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absolute monochromatic magnitude</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_apparent_mag_from_fluxden">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_apparent_mag_from_fluxden</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_apparent_mag_from_fluxden" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the apparent AB magnitude from the monochromatic flux
density at a specified dispersion value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fluxden</strong> (<em>astropy.units.Quantity</em>) – Monochromatic flux density at a given wavelength.</p></li>
<li><p><strong>dispersion</strong> (<em>float</em>) – Dispersion value (usually in wavelength).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns apparent AB magnitude.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_integrated_luminosity">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_integrated_luminosity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_integrated_luminosity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the integrated model spectrum luminosity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Input spectrum</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the source.</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology as an astropy Cosmology object</p></li>
<li><p><strong>disp_range</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – 2 element list holding the lower and upper dispersion
boundaries for the integration</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the integrated luminosity for (dispersion range in) the
input spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.calc_lwav_from_fwav">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">calc_lwav_from_fwav</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.calc_lwav_from_fwav" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the monochromatic luminosity from the monochromatic flux
density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fluxden</strong> (<em>astropy.units.Unit</em><em> or </em><em>astropy.units.Quantity</em><em> or
</em><em>astropy.units.CompositeUnit</em><em> or </em><em>astropy.units.IrreducibleUnit</em>) – Monochromatic flux density at a given wavelength.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the source.</p></li>
<li><p><strong>cosmology</strong> (<em>astropy.cosmology.Cosmology</em>) – Cosmology as an astropy Cosmology object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Monochromatic luminosity in units of erg s^-1 Angstroem^-1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_average_fluxden">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_average_fluxden</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_average_fluxden" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the average flux density of a spectrum in a window centered at
the specified dispersion and with a given width.</p>
<p>The central dispersion and width can be specified in the rest-frame and
then are redshifted to the observed frame using the redsh keyword argument.</p>
<p>Warning: this function currently only works for spectra in wavelength
units. For spectra in frequency units the conversion to rest-frame will
be incorrect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Input spectrum</p></li>
<li><p><strong>dispersion</strong> (<em>float</em>) – Central dispersion</p></li>
<li><p><strong>width</strong> (<em>float</em>) – Width of the dispersion window</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift argument to redshift the dispersion window into
the observed frame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Average flux density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_equivalent_width">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_equivalent_width</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cont_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_equivalent_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the rest-frame equivalent width of a spectral feature.</p>
<p>Warning: this function currently only works for spectra in wavelength
units. For spectra in frequency units the conversion to rest-frame will
be incorrect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cont_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Continuum spectrum</p></li>
<li><p><strong>line_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Spectrum with the feature (e.g. emission line)</p></li>
<li><p><strong>disp_range</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Dispersion range (2 element list of floats) over which
the equivalent width will be calculated.</p></li>
<li><p><strong>redshift</strong> – Redshift of the astronomical source</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Rest-frame equivalent width</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_fwhm">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_fwhm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spline'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the FWHM (in km/s) of an emission feature from the spectrum.</p>
<p>The user can specify a dispersion range to limit the FWHM calculation to
this part of the spectrum. If a resolution (R) is specified the FWHM is
corrected for the broadening due to the resolution.</p>
<p>The function will subtract a flux density value of half of the maximum
and then find the two roots (flux density = 0) of the new flux density axis.
If the emission feature has multiple components more than two roots can
be found in which case the a np.NaN value will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Input spectrum</p></li>
<li><p><strong>disp_range</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Dispersion range to which the calculation is limited.</p></li>
<li><p><strong>resolution</strong> (<em>float</em>) – Resolution in R = Lambda/Delta Lambda</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use in retrieving the FWHM. There are two
methods available. The default method ‘spline’ uses a spline to interpolate
the original spectrum and find the zero points using a root finding
algorithm on the spline. The second method ‘sign’  finds sign changes in
the half peak flux subtracted spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>FWHM of the spectral feature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_integrated_flux">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_integrated_flux</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_integrated_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the integrated flux of a spectrum.</p>
<p>The keyword argument disp_range allows to specify the dispersion
boundaries for the integration. The standard numpy.trapz function is used
for the integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – SpecOneD object holding the spectrum to integrate</p></li>
<li><p><strong>disp_range</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – 2 element list holding the lower and upper dispersion
boundaries for the integration</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integrated flux</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_nonparametric_measurements">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_nonparametric_measurements</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_rest_wavel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_nonparametric_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the velocities at different ratios of the total emission line flux.</p>
<p>These velocity measurements are referenced in the literature by (e.g.)
Whittle+1985, Liu+2013, Zakamska &amp; Greene 2014.</p>
<p>This function calculates the cumulative integral of the emission line
flux and then determines the closest dispersion values in velocity space to
the 5%, 10%, 50%, 90% and 95% total flux ratios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Input spectrum</p></li>
<li><p><strong>line_rest_wavel</strong> (<em>float</em>) – rest-frame wavelength fo the line in Angstroem</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift of the source</p></li>
<li><p><strong>disp_range</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Observed-frame dispersion range to which the
calculation is limited.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>median velocity, 5% velocity, 10% velocity, 90% velocity,
95% velocity, velocity resolution at median velocity, frequency of
median velocity, wavelength of median velocity, redshift of median
velocity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.units.Quantity, astropy.units.Quantity,
astropy.units.Quantity, astropy.units.Quantity,
astropy.units.Quantity, astropy.units.Quantity,
astropy.units.Quantity, astropy.units.Quantity, astropy.units.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.get_peak_redshift">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">get_peak_redshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rest_wave</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.get_peak_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the redshift of the flux density peak in the spectrum by
specifying the expected rest frame wavelength of the emission feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spec</strong> (<a class="reference internal" href="speconed.html#sculptor.speconed.SpecOneD" title="sculptor.speconed.SpecOneD"><em>sculptor.speconed.SpecOneD</em></a>) – Input spectrum</p></li>
<li><p><strong>rest_wave</strong> – Rest-frame wavelength of the expected emission feature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Redshift of the peak flux density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sculptor.specanalysis.k_correction_pl">
<code class="sig-prename descclassname"><span class="pre">sculptor.specanalysis.</span></code><code class="sig-name descname"><span class="pre">k_correction_pl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sculptor.specanalysis.k_correction_pl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the k-correction for a power law spectrum with spectral
index (per frequency) a_nu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Cosmological redshift of the source</p></li>
<li><p><strong>a_nu</strong> (<em>float</em>) – Power law index (per frequency)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>K-correction</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="masksmodels.html" class="btn btn-neutral float-right" title="The Masks &amp; Models Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="specfit.html" class="btn btn-neutral float-left" title="The SpecFit Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Jan-Torge Schindler.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>