<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>An introduction to the SpecOneD class &mdash; Sculptor 1.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
    <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Preparing a composite spectrum for Sculptor modeling using the SpecOneD class" href="spectrum_preparation.html" />
    <link rel="prev" title="Spectral fitting with the Sculptor GUI" href="first_fit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Sculptor
          </a>
              <div class="version">
                1.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">The Sculptor GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_fit.html">Spectral fitting with the Sculptor GUI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">An introduction to the SpecOneD class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Introducing-the-SpecOneD-object">Introducing the SpecOneD object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Manual-initialization-of-a-SpecOneD-object">Manual initialization of a SpecOneD object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-.plot()-for-quick-visualization-of-the-spectrum">Using .plot() for quick visualization of the spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-and-reading-in-SpecOneD-objects">Saving and reading in SpecOneD objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-in-spectra-from-other-formats">Reading in spectra from other formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Unit-conversions">Unit conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#%22Normalizing%22-the-flux-density-numpy.ndarray">“Normalizing” the flux density numpy.ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Manipulating-spectra">Manipulating spectra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Trimming-spectra">Trimming spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Resampling">Resampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Reducing-the-spectral-resolution-via-resampling-&amp;-binning">Reducing the spectral resolution via resampling &amp; binning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interpolating-spectra">Interpolating spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Smoothing-spectra">Smoothing spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Matching-spectra-to-the-same-dispersion-axis">Matching spectra to the same dispersion axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Renormalize-the-flux-density-between-two-spectra">Renormalize the flux density between two spectra</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#The-PassBand-class">The PassBand class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Calculating-the-spectral-flux-through-a-passband">Calculating the spectral flux through a passband</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Passband-flux">Passband flux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Passband-magnitudes-(AB-system)">Passband magnitudes (AB system)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Renormalizing-the-flux-density-to-a-passband-AB-magnitude---Absolute-flux-calibration">Renormalizing the flux density to a passband AB magnitude - Absolute flux calibration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectrum_preparation.html">Preparing a composite spectrum for Sculptor modeling using the SpecOneD class</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_1.html">Scripting Sculptor 01 - Modelling the example spectrum in a script</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_2.html">Scripting Sculptor 02 - Analysing model fits with SpecAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_3.html">Scripting Sculptor 03 - Fitting and Analzying models using MCMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="speconed.html">The SpecOneD Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specmodel.html">The SpecModel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specfit.html">The SpecFit Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specanalysis.html">The SpecAnalysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="masksmodels.html">The Masks &amp; Models Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qso_extension.html">The QSO-Extension Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_extension.html">Example extension Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sculptor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">An introduction to the SpecOneD class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/speconed_demonstration.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="An-introduction-to-the-SpecOneD-class">
<h1>An introduction to the SpecOneD class<a class="headerlink" href="#An-introduction-to-the-SpecOneD-class" title="Permalink to this heading"></a></h1>
<p>In this notebook we will demonstrate the functionality of the SpecOneD class included in the speconed module as part of <em>Sculptor</em>. SpecOneD objects are designed to hold the spectral information of an astronomical source along with ancillary information, such as the data header generated by the observatory or the reduction software or the physical units of the dispersion and flux density axis.</p>
<section id="Introducing-the-SpecOneD-object">
<h2>Introducing the SpecOneD object<a class="headerlink" href="#Introducing-the-SpecOneD-object" title="Permalink to this heading"></a></h2>
<p>We begin by introducing the SpecOneD object and its attributes. As a first step we import the SpecOneD module from sculptor and generate an emptye SpecOneD object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the speconed module from sculptor</span>
<span class="kn">from</span> <span class="nn">sculptor</span> <span class="kn">import</span> <span class="n">speconed</span> <span class="k">as</span> <span class="n">sod</span>

<span class="c1"># Instantiate an empty SpecOneD object</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We have now instantiated an empty SpecOneD object called <em>spec</em>. Let’s take a quick look at the class attributes by iterating over them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fluxden
fluxden_err
dispersion
fluxden_ivar
mask
dispersion_unit
fluxden_unit
header
fits_header
obj_model
telluric
</pre></div></div>
</div>
<p>Every SpecOneD object will be instantiated with a range of numpy.ndarrays holding information on the dispersion axis (dispersion), the flux density (fluxden), the flux density error (fluxden_err), a mask (mask). All of these arrays have to have the same length.</p>
<p>In addition, the two attributes “dispersion_unit” and “fluxden_unit” contain the information on the physical units of the dispersion axis as well as the flux density (and flux density error). These attributes are populated with astropy.units.Quantity (astropy.units.Unit, astropy.units.CompositeUnit, astropy.units.IrreducibleUnit) enabling to use the astropy.units module for unit conversion. This is also an important aspect for the analysis of the spectral models later on.</p>
<p>The “header” attribute is a pandas.DataFrame with additional information of the spectrum. If the header was populated through a fits file the original fits header is available at the “fits_header” attribute. Note that when initializing a SpecOneD object you should pass your fits header under the <em>header</em> keyword.</p>
<p>Spectra reduced by <em>PypeIt</em> and read in from the <em>PypeIt</em> fits format might carry additional information about the object_model and the telluric model from the telluric correction, which will be saved in the “obj_model” and “telluric” attributes.</p>
</section>
<section id="Manual-initialization-of-a-SpecOneD-object">
<h2>Manual initialization of a SpecOneD object<a class="headerlink" href="#Manual-initialization-of-a-SpecOneD-object" title="Permalink to this heading"></a></h2>
<p>While the SpecOneD class offers functionality to import spectra from iraf or PypeIt standard data reductions and also supports the SDSS format, it is important to know how to initialize spectra manually for custom use. For this example we use the SDSS spectrum of the quasar J030341.04-002321.8 available in the sculptor data folder.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s begin by importing astropy fits and units functionality</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">units</span>

<span class="c1"># Define the name of the example spectrum</span>
<span class="n">spec_filename</span> <span class="o">=</span> <span class="s1">&#39;../../sculptor/data/example_spectra/J030341.04-002321.8_0.fits&#39;</span>

<span class="c1"># Read in the example spectrum with astropy</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">spec_filename</span><span class="p">)</span>

<span class="c1"># Extract the dispersion axis, the flux density and the error from the fits file</span>
<span class="n">dispersion</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;loglam&#39;</span><span class="p">]</span>
<span class="n">flux_density</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span>
<span class="n">flux_density_ivar</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ivar&#39;</span><span class="p">]</span>

<span class="c1"># Extract the fits header of the spectrum</span>
<span class="n">header</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>

<span class="c1"># Before we initialize the SpecOneD object we need to convert the dispersion axis to a linear scale</span>
<span class="n">dispersion</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">dispersion</span>

<span class="c1"># The header provides information on the units of the spectrum (Let&#39;s print it out below!)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Wavelength unit: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;WAT1_001&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flux density unit: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;BUNIT&#39;</span><span class="p">]))</span>

<span class="n">dispersion_unit</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span>
<span class="n">fluxden_unit</span> <span class="o">=</span> <span class="mf">1e-17</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span>

<span class="c1"># Now we can initialize a SpecOneD object manually</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">(</span><span class="n">dispersion</span><span class="o">=</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">fluxden</span><span class="o">=</span><span class="n">flux_density</span><span class="p">,</span> <span class="n">fluxden_ivar</span><span class="o">=</span><span class="n">flux_density_ivar</span><span class="p">,</span>
                   <span class="n">fluxden_unit</span><span class="o">=</span><span class="n">fluxden_unit</span><span class="p">,</span> <span class="n">dispersion_unit</span><span class="o">=</span><span class="n">dispersion_unit</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wavelength unit: wtype=linear label=Wavelength units=Angstroms
Flux density unit: 1E-17 erg/cm^2/s/Ang
</pre></div></div>
</div>
<p><strong>We have done it! We have manually initialized a SpecOneD object</strong></p>
<p>Let us now take a closer look if everything worked. We begin by checking the types and shapes of the main SpecOneD attributes: <em>flux density</em>, <em>dispersion</em>, <em>mask</em>, <em>flux density error</em>, the units and the header</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flux density -  type </span><span class="si">{}</span><span class="s1">, size </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">fluxden</span><span class="p">),</span> <span class="n">spec</span><span class="o">.</span><span class="n">fluxden</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dispersion axis -  type </span><span class="si">{}</span><span class="s1">, size </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">dispersion</span><span class="p">),</span> <span class="n">spec</span><span class="o">.</span><span class="n">dispersion</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flux density error -  type </span><span class="si">{}</span><span class="s1">, size </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">fluxden_err</span><span class="p">),</span> <span class="n">spec</span><span class="o">.</span><span class="n">fluxden_err</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mask -  type </span><span class="si">{}</span><span class="s1">, size </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">mask</span><span class="p">),</span> <span class="n">spec</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dispersion unit -  value </span><span class="si">{}</span><span class="s1"> and type </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flux density unit - value </span><span class="si">{}</span><span class="s1"> and type </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Header DataFrame </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Flux density -  type &lt;class &#39;numpy.ndarray&#39;&gt;, size (3614,)

Dispersion axis -  type &lt;class &#39;numpy.ndarray&#39;&gt;, size (3614,)

Flux density error -  type &lt;class &#39;numpy.ndarray&#39;&gt;, size (3614,)

Mask -  type &lt;class &#39;numpy.ndarray&#39;&gt;, size (3614,)

Dispersion unit -  value 1.0 Angstrom and type &lt;class &#39;astropy.units.quantity.Quantity&#39;&gt;

Flux density unit - value 1e-17 erg / (Angstrom cm2 s) and type &lt;class &#39;astropy.units.quantity.Quantity&#39;&gt;

Header DataFrame
                                  value
SIMPLE                            True
BITPIX                               8
NAXIS                                0
EXTEND                            True
TAI                      4477028053.74
...                                ...
EXPID02  b1-00006799-00006802-00006803
EXPID03  b1-00006800-00006802-00006803
EXPID04  r1-00006798-00006802-00006803
EXPID05  r1-00006799-00006802-00006803
EXPID06  r1-00006800-00006802-00006803

[138 rows x 1 columns]
</pre></div></div>
</div>
<p>Everything seems to look reasonable here. However, a visual inspection of the spectrum will be necessary to convince us that it was read in correctly. For this purpose the SpecOneD class offers a simple plot functionality:</p>
</section>
<section id="Using-.plot()-for-quick-visualization-of-the-spectrum">
<h2>Using .plot() for quick visualization of the spectrum<a class="headerlink" href="#Using-.plot()-for-quick-visualization-of-the-spectrum" title="Permalink to this heading"></a></h2>
<p>The spectrum can be plotted with the built-in plot functionality, which uses matplotlib. Note that the units in the axis labels will be automatically populated by the units from the SpecOneD object (spec.dispersion_unit, spec.fluxden_unit).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_11_0.png" src="_images/speconed_demonstration_11_0.png" />
</div>
</div>
<p>We expect the source to be a quasar at redshift z=3.227. Therefore we expect the Lyman-alpha emission line around 5140A. A look at the plot convinces us that the spectrum was read in correctly, including the axis units.</p>
</section>
<section id="Saving-and-reading-in-SpecOneD-objects">
<h2>Saving and reading in SpecOneD objects<a class="headerlink" href="#Saving-and-reading-in-SpecOneD-objects" title="Permalink to this heading"></a></h2>
<p>Sculptor and the Sculptor GUI require a SpecOneD object as input. The GUI allow to import spectra from a few common fits formats or from a saved SpecOneD object.</p>
<p>SpecOneD allows to save spectra to the <em>hdf</em> format, which is the native way to save spectra within the SpecOneD class. The spectral data, meta data and the header will be saved in a file, which can be easily imported to the Sculptor GUI.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Saving the SpecOneD spectrum in its native format</span>
<span class="n">spec</span><span class="o">.</span><span class="n">save_to_hdf</span><span class="p">(</span><span class="s1">&#39;temp_spectrum.hdf5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/anaconda3/envs/sculptor-env/lib/python3.9/site-packages/pandas/core/generic.py:2606: PerformanceWarning:
your performance may suffer as PyTables will pickle object types that it cannot
map directly to c-types [inferred_type-&gt;mixed-integer,key-&gt;block0_values] [items-&gt;Index([&#39;value&#39;], dtype=&#39;object&#39;)]

  pytables.to_hdf(
</pre></div></div>
</div>
<p>In a similar fashion we can read in the spectrum again:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Before we read in a SpecOneD object, we need to initialize an empty object</span>
<span class="n">new_spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="c1"># Then we use the read_from_hdf function and the filename</span>
<span class="n">new_spec</span><span class="o">.</span><span class="n">read_from_hdf</span><span class="p">(</span><span class="s1">&#39;temp_spectrum.hdf5&#39;</span><span class="p">)</span>

<span class="c1"># As a test we plot the spectrum</span>
<span class="n">new_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># and test if the header was saved and read in correctly</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flux density unit according to header is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_spec</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BUNIT&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">]))</span>

<span class="c1"># However, the fits header attribute is not populated</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The fits header attribute is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_spec</span><span class="o">.</span><span class="n">fits_header</span><span class="p">))</span>

<span class="c1"># To keep the notebook directoy clean we delete the temporary spectrum file</span>
<span class="o">!</span><span class="w"> </span>rm<span class="w"> </span>temp_spectrum.hdf5
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_16_0.png" src="_images/speconed_demonstration_16_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Flux density unit according to header is 1E-17 erg/cm^2/s/Ang
The fits header attribute is: None
</pre></div></div>
</div>
<p>Great! The spectrum was saved and read in correctly.</p>
<p><strong>Note: Because we did not initialize the new spectrum from a fits file the fits_header attribute is None.</strong></p>
</section>
<section id="Reading-in-spectra-from-other-formats">
<h2>Reading in spectra from other formats<a class="headerlink" href="#Reading-in-spectra-from-other-formats" title="Permalink to this heading"></a></h2>
<p>In the current version of Sculptor the SpecOneD module has three implemented methods to read in spectra from * an IRAF 1D fits file (in many cases the flux density and dispersion units need to be set manually) * an PypeIT 1D fits file * an SDSS fits file</p>
<p>These read function automizes the steps of the manual initialization above. We now go through quick examples:</p>
<p>We begin by readin in the SDSS quasar spectrum from before in only two lines:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initializing an empty SpecOneD object</span>
<span class="n">sdss_spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="c1"># Read in the spectrum using the SDSS read function</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">read_sdss_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J030341.04-002321.8_0.fits&#39;</span><span class="p">)</span>
<span class="c1"># Plot the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_18_0.png" src="_images/speconed_demonstration_18_0.png" />
</div>
</div>
<p>The Sculptor data directory also includes example (quasar) spectra in IRAF and PypeIT fits format. Reading them in as a SpecOneD object is just as simple as in the case of the SDSS spectrum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initializing an empty SpecOneD object</span>
<span class="n">iraf_spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="c1"># Read in the spectrum using the IRAF read function</span>
<span class="n">iraf_spec</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_A.fits&#39;</span><span class="p">)</span>
<span class="c1"># Plot the spectrum</span>
<span class="n">iraf_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Initializing an empty SpecOneD object</span>
<span class="n">pypeit_spec</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="c1"># Read in the spectrum using the PypeIt read function</span>
<span class="n">pypeit_spec</span><span class="o">.</span><span class="n">read_pypeit_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_NIR.fits&#39;</span><span class="p">)</span>
<span class="c1"># Plot the spectrum</span>
<span class="n">pypeit_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_20_0.png" src="_images/speconed_demonstration_20_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_20_1.png" src="_images/speconed_demonstration_20_1.png" />
</div>
</div>
<p>The first plot shows the optical spectrum of the ultra-luminous quasar J2125-1719, whereas the second shows the near-infrared spectrum.</p>
<p>The second plot however does show additional information, the object model (orange) and the atmospheric transmission (blue) from the PypeIt telluric correction routines. It also shows that the default <em>.plot()</em> capabilities of the SpecOneD class are not appropriate for generating publication grade figures as the legends in the second plot are not well placed.</p>
</section>
<section id="Unit-conversions">
<h2>Unit conversions<a class="headerlink" href="#Unit-conversions" title="Permalink to this heading"></a></h2>
<p>With the flux density and dispersion units included as astropy unit classes within the SpecOneD object, we have all the great unit conversion functionality of astropy.units at our disposal. We want to briefly demonstrate how this works. Let us begin again with our default SDSS quasar spectrum <em>sdss_spec</em>. The default units were</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sdss_spec</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sdss_spec</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1e-17 erg / (Angstrom cm2 s)
1.0 Angstrom
</pre></div></div>
</div>
<p>The function <em>convert_spectral_units</em> allows us to convert the spectral units by specifying the new dispersion and new flux density unit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the dispersion to meters and the flux density to Jansky</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">Jy</span><span class="p">)</span>
<span class="c1"># Display the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_25_0.png" src="_images/speconed_demonstration_25_0.png" />
</div>
</div>
<p>As long as the new units are reasonable for a flux density and a dispersion axis, you will be able to convert the spectrum. Internally the conversion uses <em>spectral</em> and <em>spectral_density</em> equivalencies, which will lead to an error if one would choose units that do not obey these equivalencies. Please consult the <a class="reference external" href="https://docs.astropy.org/en/stable/units/equivalencies.html">astropy documentation</a> for details.</p>
<p>For our case, the SpecOneD class comes with default conversion functions for common spectral units:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert SpecOneD spectrum to flux density per unit frequency (Hz) in cgs units.</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">to_fluxden_per_unit_frequency_cgs</span><span class="p">()</span>
<span class="c1"># Display the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Convert SpecOneD spectrum to flux density per unit frequency (Hz) in Jy.</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">to_fluxden_per_unit_frequency_jy</span><span class="p">()</span>
<span class="c1"># Display the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Convert SpecOneD spectrum to flux density per unit frequency (Hz) in SI units.</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">to_fluxden_per_unit_frequency_si</span><span class="p">()</span>
<span class="c1"># Display the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Convert SpecOneD spectrum to flux density per unit wavelength (Angstroem) in cgs units.</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">to_fluxden_per_unit_wavelength_cgs</span><span class="p">()</span>
<span class="c1"># Display the spectrum</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_27_0.png" src="_images/speconed_demonstration_27_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_27_1.png" src="_images/speconed_demonstration_27_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_27_2.png" src="_images/speconed_demonstration_27_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_27_3.png" src="_images/speconed_demonstration_27_3.png" />
</div>
</div>
<p>After all these conversion the last one brought us back to flux density per unit wavelength in the same units that we originally read the spectrum in - with one major difference: the 1e-17 factor in front of the flux density has been multiplied to the numpy.ndarray of the flux density and been removed from the flux density unit. However, in these particular units the flux density has very low numerical values, which could pose a problem to fitting algorithms. Therefore, we want to normalize the
flux density numerical values and hide large factors in the unit.</p>
</section>
<section id="%22Normalizing%22-the-flux-density-numpy.ndarray">
<h2>“Normalizing” the flux density numpy.ndarray<a class="headerlink" href="#%22Normalizing%22-the-flux-density-numpy.ndarray" title="Permalink to this heading"></a></h2>
<p>Within SpecOneD we provide three functions that allow to “normalize” the flux density numpy.ndarray. The first function calculates the median flux density error and normalizes the flux density unit accordingly.</p>
<p><strong>Note that these function return a new SpecOneD object by default. In fact, the majority of the SpecOneD functions that manipulate or modify the spectrum return a modified copy by defaul. This approach is designed to leave the original spectrum untouched. However, you can overwrite the original spectrum by using the inplace keyword argument of those functions and set it to True.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize flux density unit by flux density error</span>
<span class="n">nspec</span> <span class="o">=</span> <span class="n">sdss_spec</span><span class="o">.</span><span class="n">normalize_fluxden_by_error</span><span class="p">()</span>
<span class="n">nspec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_29_0.png" src="_images/speconed_demonstration_29_0.png" />
</div>
</div>
<p>As you can see, the flux density axis now shows that its unit is ~1.12 * 1e-17 erg/s/cm^2/A. However, in many cases we want to set a specific pre-factor to the flux density unit or modify it by a specific factor. For this purpose two additional functions exist:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize the spectrum BY a specific unit factor of 1e-15.</span>
<span class="n">nspec</span> <span class="o">=</span> <span class="n">sdss_spec</span><span class="o">.</span><span class="n">normalize_fluxden_by_factor</span><span class="p">(</span><span class="mf">1e-15</span><span class="p">)</span>
<span class="n">nspec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Applying the same factor again, might lead to ridiculous pre-factors</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nspec</span><span class="o">.</span><span class="n">normalize_fluxden_by_factor</span><span class="p">(</span><span class="mf">1e-15</span><span class="p">)</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">)</span>

<span class="c1"># Normalize the spectrum TO a specific unit pre-factor</span>
<span class="n">nspec</span> <span class="o">=</span> <span class="n">sdss_spec</span><span class="o">.</span><span class="n">normalize_fluxden_to_factor</span><span class="p">(</span><span class="mf">1e-17</span><span class="p">)</span>
<span class="n">nspec</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_31_0.png" src="_images/speconed_demonstration_31_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1e-30 erg / (Angstrom cm2 s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_31_2.png" src="_images/speconed_demonstration_31_2.png" />
</div>
</div>
</section>
<section id="Manipulating-spectra">
<h2>Manipulating spectra<a class="headerlink" href="#Manipulating-spectra" title="Permalink to this heading"></a></h2>
<p>In order to prepare the science spectrum for analysis one often has to manipulate the spectral data. This includes resampling the spectra to a pre-defined resolution, trimming the spectra, or matching multiple spectra to construct a composite spectrum. The SpecOneD class provides functionality for all of these cases.</p>
<section id="Trimming-spectra">
<h3>Trimming spectra<a class="headerlink" href="#Trimming-spectra" title="Permalink to this heading"></a></h3>
<p>Trimming spectral data with SpecOneD is implemented in the function <em>trim_dispersion</em>. A tuple of two float values provide the lower and upper limits of the new spectrum. By default the numerical limits are assumed to be in units of the dispersion axis (<em>mode=’physical’</em>) and trim the spectrum at the closest points in dispersion units. Alternatively, one can change the mode to <em>mode=’pixel’</em> and then trim the spectra according to the pixel number. By default the function will return a new
spectrum. In case the user wants to overwrite the old spectrum, one can specify this by <em>inplace=True</em> in the function. If we return a new spectrum, we can immediately plot it by chaining the <em>.plot()</em> function to the trimming function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trim and plot the SDSS quasar spectrum in dispersion units</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">trim_dispersion</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span><span class="mi">6000</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Trim and plot the SDSS quasar spectrum in pixel units</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">trim_dispersion</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pixel&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_33_0.png" src="_images/speconed_demonstration_33_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_33_1.png" src="_images/speconed_demonstration_33_1.png" />
</div>
</div>
</section>
<section id="Resampling">
<h3>Resampling<a class="headerlink" href="#Resampling" title="Permalink to this heading"></a></h3>
<p>In some cases one wants to resample the spectrum to a constant resolution to the resolution of another spectrum. For these cases Sculptor uses <a class="reference external" href="https://github.com/ACCarnall/SpectRes">SpectRes package</a> by Adam Carnall. The SpecOneD class provides a wrapper function called <em>resample</em> that applies the SpectRes resample method to the SpecOneD object.</p>
<p>As an argument it takes the new resolution as an numpy.ndarray.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Setting up the new dispersion axis</span>
<span class="n">new_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4500</span><span class="p">,</span><span class="mi">6500</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">sdss_spec</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">new_dispersion</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_35_0.png" src="_images/speconed_demonstration_35_0.png" />
</div>
</div>
<p>We have now created a lower resolution version of the previous SDSS quasar spectrum in the dispersion range of 4500A to 6500A. However, what happens if the new dispersion range is not covered by the spectrum?</p>
<p>In the current implementation this will automatically return an Error! However, one can set the keyword argument <em>force=True</em>, which will force the new dispersion range to be within the original spectral dispersion, trimming it automatically. This will prompt a warning message, so that the user is aware of the modifications by the function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting up the new dispersion axis</span>
<span class="n">new_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">6500</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">sdss_spec</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">new_dispersion</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[WARNING] Forcing new spectral dispersion axis to be within the limits of the old spectral dispersion.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_37_1.png" src="_images/speconed_demonstration_37_1.png" />
</div>
</div>
</section>
<section id="Reducing-the-spectral-resolution-via-resampling-&amp;-binning">
<h3>Reducing the spectral resolution via resampling &amp; binning<a class="headerlink" href="#Reducing-the-spectral-resolution-via-resampling-&-binning" title="Permalink to this heading"></a></h3>
<p>In some cases it becomes necessary to reduce the resolution of a spectrum to increase the signal-to-noise ratio. Within the SpecOneD class this can either be achieved by resampling the spectrum to a dispersion with wider pixel sizes or by binning multiple pixels.</p>
<p>The <em>resample_to_resolution</em> function uses the <em>resample</em> method discussed above to automatically the spectrum to a new dispersion axis with the resolution in km/s provided by the argument. The <em>buffer</em> keyword argument (default value = 2) determines how many pixels at the beginning and the end of the spectrum will be omitted in the resampling process.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resample the spectrum to a resolution of 300 km/s</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">resample_to_resolution</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_39_0.png" src="_images/speconed_demonstration_39_0.png" />
</div>
</div>
<p>Binning the spectrum by an integer number of pixels can be achieve with the <em>bin_by_npixels</em> function. One has to simply specify the number of pixels that should be binned.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdss_spec</span><span class="o">.</span><span class="n">bin_by_npixels</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_41_0.png" src="_images/speconed_demonstration_41_0.png" />
</div>
</div>
</section>
<section id="Interpolating-spectra">
<h3>Interpolating spectra<a class="headerlink" href="#Interpolating-spectra" title="Permalink to this heading"></a></h3>
<p>While interpolating spectra onto a new spectral axis will cause the flux density and flux density errors to be correlated, it can be useful in many cases (generating figures). In the SpecOneD module we use interpolation of spectral data onto new dispersion axis in a range of contexts. The functions <em>broaden_by_gaussian</em>, <em>calculate_passband_flux</em>, <em>calculate_passband_ab_magnitude</em> all use the <em>interpolate</em> function internally.</p>
<p>The function uses the scipy.interpolate.interp1d method and takes the new dispersion as the argument. By default it will linearly interpolate (<em>kind=’linear’</em>) the flux density and flux density error to the new dispersion axis, padding values outside the original dispersion range with a constant (<em>fill_value=’const’</em>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting up the new dispersion axis</span>
<span class="n">new_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3500</span><span class="p">,</span><span class="mi">6500</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">sdss_spec</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">new_dispersion</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_43_0.png" src="_images/speconed_demonstration_43_0.png" />
</div>
</div>
<p>There are differences between the <em>resample</em> and <em>interpolate</em> methods that are especially evident when sampled with a low resolution. In addition the SpectRes <em>resample</em> calculates the resulting flux density error more accurately, while the <em>interpolate</em> function only adjusts the signal to noise ratio by the resolution factor ( sqrt(“old resolution”/”new resolution”)).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting up the new dispersion axis</span>
<span class="n">new_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4500</span><span class="p">,</span><span class="mi">6500</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">resampled</span> <span class="o">=</span> <span class="n">sdss_spec</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">new_dispersion</span><span class="p">)</span>
<span class="n">interpolated</span> <span class="o">=</span> <span class="n">sdss_spec</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">new_dispersion</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resampled</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">resampled</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;resampled&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interpolated</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">interpolated</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resampled</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">resampled</span><span class="o">.</span><span class="n">fluxden_err</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;resampled err&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interpolated</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">interpolated</span><span class="o">.</span><span class="n">fluxden_err</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interpolated err&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_45_0.png" src="_images/speconed_demonstration_45_0.png" />
</div>
</div>
</section>
<section id="Smoothing-spectra">
<h3>Smoothing spectra<a class="headerlink" href="#Smoothing-spectra" title="Permalink to this heading"></a></h3>
<p>In addition the methods described above one can also smooth the spectrum using a boxcar or gaussian kernel. SpecOneD uses the astropy.convolution functionality to achieve this. The function takes the width (in pixels) of the kernel as an argument. Keyword arguments determine the kernel (default <em>kernel=”boxcar”</em>) and whether the signal-to-noise ratio will be adjusted (default <em>scale_sigma=True</em>) by sqrt(width).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Smooth the spectrum with a boxcar kernel of size 5 pixels and plot it</span>
<span class="n">sdss_spec</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_47_0.png" src="_images/speconed_demonstration_47_0.png" />
</div>
</div>
</section>
<section id="Matching-spectra-to-the-same-dispersion-axis">
<h3>Matching spectra to the same dispersion axis<a class="headerlink" href="#Matching-spectra-to-the-same-dispersion-axis" title="Permalink to this heading"></a></h3>
<p>One of the applications of resampling spectra is to match two spectra of the same source, but observed with at different resolution to the same dispersion.</p>
<p>For this purpose the SpecOneD class has a function called <em>match_dispersions</em>. The documentation for this function reads:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Match the dispersion of the current spectrum and the secondary
spectrum.

Both, current and secondary, SpecOneD objects are modified in this
process. The dispersion match identifies the maximum possible overlap
in the dispersion direction of both spectra and automatically trims
them to that range.

If the current (primary) spectrum overlaps fully with the secondary
spectrum the dispersion of the secondary will be interpolated/resampled
to the primary dispersion.

If the secondary spectrum overlaps fully with the primary, the primary
spectrum will be interpolated/resampled on the secondary spectrum
resolution, but this will only be executed if &#39;force==True&#39; and
&#39;match_secondary==False&#39;.

If there is partial overlap between the spectra and &#39;force==True&#39;
the secondary spectrum will be interpolated/resampled to match the
dispersion values of the primary spectrum.

If there is no overlap a ValueError will be raised.
</pre></div>
</div>
<p>We now demonstrate how use this function with a quick example. We use two spectra from the example folder of the ultra-luminous quasar J2125-1719. These optical spectra cover a different dispersion range, so we will see how the function works in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the spectra of J2125-1719</span>
<span class="n">specoptA</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_A.fits&#39;</span><span class="p">)</span>
<span class="n">specoptB</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_B.fits&#39;</span><span class="p">)</span>

<span class="c1"># The optical spectra will be scaled to 1e-17 erg/s/cm^2/A</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>

<span class="c1"># Plot the spectra before matching them</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_49_0.png" src="_images/speconed_demonstration_49_0.png" />
</div>
</div>
<p>Now we will use the match dispersion function to match the dispersion of spectrum A to spectrum B. The <em>match_secondary</em> keyword indicates whether the secondary dispersion axis will always be matched to the primary spectrum of if the reverse is allowed. The default matching method is interpolation (<em>method=’interpolate’)</em>.</p>
<p>If the primary spectrum (here specoptA) is not fully contained within the dispersion range of the secondary spectrum (here specoptB), we need to set <em>force=True</em> to allow the primary spectrum to be reduced to the overlap region of both spectra.</p>
<p><strong>Note that the match_dispersions function does NOT have a inplace keyword argument. This functions ALWAYS modifies both original spectra!</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specoptA</span><span class="o">.</span><span class="n">match_dispersions</span><span class="p">(</span><span class="n">specoptB</span><span class="p">,</span> <span class="n">match_secondary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;interpolate&#39;</span><span class="p">,</span>
                          <span class="n">interp_method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="c1"># Plot the spectra AFTER matching them</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($1e-17\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_51_0.png" src="_images/speconed_demonstration_51_0.png" />
</div>
</div>
<p>The plot illustrates that both spectra have been automatically cut to their overlap region. In this range the dispersion axes of both spectra are now identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[5316.3259873  5318.30567772 5320.28536813 ... 8008.70494917 8010.68463959
 8012.66433   ]
[5316.3259873  5318.30567772 5320.28536813 ... 8008.70494917 8010.68463959
 8012.66433   ]
</pre></div></div>
</div>
</section>
<section id="Renormalize-the-flux-density-between-two-spectra">
<h3>Renormalize the flux density between two spectra<a class="headerlink" href="#Renormalize-the-flux-density-between-two-spectra" title="Permalink to this heading"></a></h3>
<p>The SpecOneD class also includes methods to renormalize the spectral flux density either to a secondary spectrum or a passband magnitude. For now we will demonstrate how one can match the flux density of one spectrum to a different one in their overlap region. For this example we use the optical spectra of quasar J2125-1719 above.</p>
<p>The SpecOneD function to carry out the renormalization is aptly named <em>renormalize_by_spectrum</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the spectra of J2125-1719</span>
<span class="n">specoptA</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_A.fits&#39;</span><span class="p">)</span>
<span class="n">specoptB</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_B.fits&#39;</span><span class="p">)</span>

<span class="c1"># The optical spectra will be scaled to 1e-17 erg/s/cm^2/A</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>

<span class="c1"># Plot the spectra before renomalizing the flux density</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_55_0.png" src="_images/speconed_demonstration_55_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Renormalize the flux density of spectrum B to spectrum A in the overlap region of 6000A-7000A.</span>
<span class="n">nspecoptB</span> <span class="o">=</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">renormalize_by_spectrum</span><span class="p">(</span><span class="n">specoptA</span><span class="p">,</span> <span class="n">dispersion_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">6000</span><span class="p">,</span><span class="mi">7000</span><span class="p">])</span>

<span class="c1"># Plot the spectra after renomalizing the flux density</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spectrum A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Renormalized spectrum B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_56_0.png" src="_images/speconed_demonstration_56_0.png" />
</div>
</div>
<p>If the dispersion limits for the overlap region are not specified, the full dispersion overlap of both spectra will be automatically chosen. <strong>If one decides to choose dispersion limits that are not appropriate, the function will NOT stop you from doing so and return an incorrectly scaled spectrum.</strong></p>
<p>The default <em>output_mode</em> (<em>output_mode=’spectrum’</em>) returns a SpecOneD object. Alternatively one can specify <em>output_mode=’flux_factor’</em> and the function will return the factor by which the spectrum should be scaled to match the flux density of the other one as a float value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the scaling factor to scale spectrum B to spectrum A in the overlap region of 6000A-7000A.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">renormalize_by_spectrum</span><span class="p">(</span><span class="n">specoptA</span><span class="p">,</span> <span class="n">dispersion_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">6000</span><span class="p">,</span><span class="mi">7000</span><span class="p">],</span> <span class="n">output_mode</span><span class="o">=</span><span class="s1">&#39;flux_factor&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.6855747992533456
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="The-PassBand-class">
<h1>The PassBand class<a class="headerlink" href="#The-PassBand-class" title="Permalink to this heading"></a></h1>
<p>The PassBand class is a child class of SpecOneD designed to store and manipulate filter transmission curves from various telescopes. The Sculptor package includes a range of filter transmission curves from various sources in the data/passbands folder.</p>
<p>These transmission curves can be automatically loaded into PassBand objects by using their name (omitting the .dat extension). They provide important functionality to the SpecOneD class for calculating passband fluxes or magnitudes and allow absolute flux normalization by the passband AB magnitude.</p>
<p>Let us start by loading the SDSS r-band filter provided by Sculptor.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the SDSS r-band filter as a PassBand object</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="s1">&#39;SDSS-r&#39;</span><span class="p">)</span>

<span class="c1"># Plot the SDSS r-band using the built in plot functionality</span>
<span class="n">pb</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_60_0.png" src="_images/speconed_demonstration_60_0.png" />
</div>
</div>
<p>Many SpecOneD functions that manipulate the dispersion axis also work on passbands. This includes <em>trim_dispersion</em> or <em>match_dispersion</em>, for example. However, some functionality requires flux densities and flux density errors and thus won’t work with the PassBand class.</p>
<section id="Calculating-the-spectral-flux-through-a-passband">
<h2>Calculating the spectral flux through a passband<a class="headerlink" href="#Calculating-the-spectral-flux-through-a-passband" title="Permalink to this heading"></a></h2>
<section id="Passband-flux">
<h3>Passband flux<a class="headerlink" href="#Passband-flux" title="Permalink to this heading"></a></h3>
<p>For this example we will use the quasar spectrum of J030341.04-002321.8 again. We have already initialized the SDSS r-band as pb above, which we will be using in this example. The function that calculates the total passband flux is <em>calculate_passband_flux</em>.</p>
<p>**Disclaimer: This function is written for passbands in quantum efficiency. Therefore, the (h*nu)^-1 term is not included in the integral.**</p>
<p>Therefore, if you want to use passbands that are not in quantum efficiency you need to write your own function.</p>
<p>To match the passband and the spectrum to the same dispersion axis we can use either the <em>resample</em> or the <em>interpolate</em> methods described above. The lead to slightly different results, as can be seen below. If the spectrum does not fully overlap the passband one can set <em>force=True</em> to calculate the flux only in the overlap region. For this example we do not need to do that. (Setting <em>force=True</em> also prompts multiple warnings instructing the user to be especially careful with the intepretation
of the results!)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the sdss quasar spectrum</span>
<span class="n">spec</span><span class="o">.</span><span class="n">read_sdss_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J030341.04-002321.8_0.fits&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the passband flux using the interpolate method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">calculate_passband_flux</span><span class="p">(</span><span class="n">pb</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">match_method</span><span class="o">=</span><span class="s1">&#39;interpolate&#39;</span><span class="p">))</span>
<span class="c1"># Calculate the passband flux using the resample method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">calculate_passband_flux</span><span class="p">(</span><span class="n">pb</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">match_method</span><span class="o">=</span><span class="s1">&#39;resample&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.4209075815160446e-13 erg / (cm2 s)
1.4108874707002708e-13 erg / (cm2 s)
</pre></div></div>
</div>
</section>
<section id="Passband-magnitudes-(AB-system)">
<h3>Passband magnitudes (AB system)<a class="headerlink" href="#Passband-magnitudes-(AB-system)" title="Permalink to this heading"></a></h3>
<p>The SpecOneD class also allows to calculate the passband magnitude in the AB system with the <em>calculate_passband_ab_magnitude</em> function. It works pretty much identical to the <em>calculate_passband_flux</em> above, but returns the AB magnitude through the filter passband.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the passband flux in AB magnitudes using the interpolate method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">match_method</span><span class="o">=</span><span class="s1">&#39;interpolate&#39;</span><span class="p">))</span>
<span class="c1"># Calculate the passband flux in AB magnitudes using the resample method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">match_method</span><span class="o">=</span><span class="s1">&#39;resample&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
17.60633670754543
17.61403048355622
</pre></div></div>
</div>
</section>
</section>
<section id="Renormalizing-the-flux-density-to-a-passband-AB-magnitude---Absolute-flux-calibration">
<h2>Renormalizing the flux density to a passband AB magnitude - Absolute flux calibration<a class="headerlink" href="#Renormalizing-the-flux-density-to-a-passband-AB-magnitude---Absolute-flux-calibration" title="Permalink to this heading"></a></h2>
<p>In some cases the absolute flux calibration of the observations might be inaccurate. Renormalizing the flux density of the spectrum through a passband to the passband photometry provides the best solution for an absolute flux calibration in these cases.</p>
<p>For this purpose the SpecOneD class offers the <em>renormalize_by_ab_magnitude</em> function, which words very similar to the <em>renormalize_by_spectrum</em> function above.</p>
<p>For the SDSS quasar we use as an example, the DR16 r-band magnitude is r=17.65. According to the SDSS website the r-band magnitude is close to AB, so we assume that r(AB)=17.65 in this case. We use the r-band from above and first decide to use the <em>output_mode=’flux_factor’</em>. By default the <em>match_method</em> is set to <em>interpolate</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SDSS r-band magnitude in AB</span>
<span class="n">rmag_ab</span> <span class="o">=</span> <span class="mf">17.65</span>

<span class="c1"># Calculate the scaling factor for absolute flux calibration</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">rmag_ab</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s1">&#39;flux_factor&#39;</span><span class="p">))</span>
<span class="c1"># Calculate the scaling factor for absolute flux calibration using the resample match method</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">rmag_ab</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s1">&#39;flux_factor&#39;</span><span class="p">,</span> <span class="n">match_method</span><span class="o">=</span><span class="s1">&#39;resample&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9605825280212889
0.9674136110722544
</pre></div></div>
</div>
<p>The flux factors already suggest that the SDSS quasar spectrum has a pretty good absolute flux calibration.</p>
<p>Now that we checked the flux factor output, we can run a simple test. First, we calculate the AB magnitude of the SDSS quasar spectrum in the r-band, then we normalize it to the r-band magnitude and lastly we calculate the AB magnitude again to check if the normalization was successfull. We will use the <em>interpolate</em> match method in all cases as it is the default.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the passband flux in AB magnitudes using the interpolate method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r-band magnitude (before): &#39;</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb</span><span class="p">))</span>

<span class="c1"># Renormalize the spectrum to the r-band magnitude</span>
<span class="n">nspec</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">rmag_ab</span><span class="p">,</span> <span class="n">pb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Absolute flux calibration to r=17.65&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the passband flux in AB magnitudes using the interpolate method to match the dispersions.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r-band magnitude (after): &#39;</span><span class="p">,</span> <span class="n">nspec</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb</span><span class="p">))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
r-band magnitude (before):  17.60633670754543
Absolute flux calibration to r=17.65
r-band magnitude (after):  17.649999999999995
</pre></div></div>
</div>
<p>We have now absolute flux calibrated the SDSS quasar spectrum to numerical accuracy. We end this demonstration of the capabilies of the SpecOneD and PassBand classes by plotting the SDSS quasar spectrum before and after absolute flux calibration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the spectra after renomalizing the flux density</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Before&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspec</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspec</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Dispersion ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux density ($1e-17\rm</span><span class="si">{erg}</span><span class="s1">/\rm</span><span class="si">{s}</span><span class="s1">/\rm</span><span class="si">{cm}</span><span class="s1">^2/\AA$))&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/speconed_demonstration_71_0.png" src="_images/speconed_demonstration_71_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="first_fit.html" class="btn btn-neutral float-left" title="Spectral fitting with the Sculptor GUI" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spectrum_preparation.html" class="btn btn-neutral float-right" title="Preparing a composite spectrum for Sculptor modeling using the SpecOneD class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jan-Torge Schindler.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>