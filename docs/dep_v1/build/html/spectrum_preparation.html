<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preparing a composite spectrum for Sculptor modeling using the SpecOneD class &mdash; Sculptor 1.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
    <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scripting Sculptor 01 - Modelling the example spectrum in a script" href="scripting_sculptor_1.html" />
    <link rel="prev" title="An introduction to the SpecOneD class" href="speconed_demonstration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Sculptor
          </a>
              <div class="version">
                1.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">The Sculptor GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_fit.html">Spectral fitting with the Sculptor GUI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="speconed_demonstration.html">An introduction to the SpecOneD class</a></li>
<li class="toctree-l1"><a class="reference internal" href="speconed_demonstration.html#The-PassBand-class">The PassBand class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Preparing a composite spectrum for Sculptor modeling using the SpecOneD class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Deredden-the-science-spectrum">Deredden the science spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Absolute-flux-calibration-to-broad-band-photometry">Absolute flux calibration to broad band photometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Absolute-flux-calibration-of-the-near-infrared-spectrum">Absolute flux calibration of the near-infrared spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Absolute-flux-calibration-of-the-optical-spectra">Absolute flux calibration of the optical spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Flux-calibrated-spectra">Flux calibrated spectra</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Building-a-composite-spectrum">Building a composite spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-the-final-composite-spectrum">Saving the final composite spectrum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_1.html">Scripting Sculptor 01 - Modelling the example spectrum in a script</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_2.html">Scripting Sculptor 02 - Analysing model fits with SpecAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting_sculptor_3.html">Scripting Sculptor 03 - Fitting and Analzying models using MCMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="speconed.html">The SpecOneD Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specmodel.html">The SpecModel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specfit.html">The SpecFit Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="specanalysis.html">The SpecAnalysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="masksmodels.html">The Masks &amp; Models Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qso_extension.html">The QSO-Extension Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_extension.html">Example extension Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sculptor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Preparing a composite spectrum for Sculptor modeling using the SpecOneD class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/spectrum_preparation.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Preparing-a-composite-spectrum-for-Sculptor-modeling-using-the-SpecOneD-class">
<h1>Preparing a composite spectrum for Sculptor modeling using the SpecOneD class<a class="headerlink" href="#Preparing-a-composite-spectrum-for-Sculptor-modeling-using-the-SpecOneD-class" title="Permalink to this heading"></a></h1>
<p>In this example we will be preparing two optical and one near-infrared spectrum for further spectral modeling using the Sculptor GUI. The spectra are of the ultra-luminous quasar J2125-1719 and are published in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2021ApJ...906...12S/abstract">Schindler et al. 2020</a>.</p>
<p>First, we import the SpecOneD module from Sculptor and read in the three spectra from the example folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sculptor</span> <span class="kn">import</span> <span class="n">speconed</span> <span class="k">as</span> <span class="n">sod</span>

<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>

<span class="c1"># Read in the spectra of J2125-1719</span>
<span class="n">specnir</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specnir</span><span class="o">.</span><span class="n">read_pypeit_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_NIR.fits&#39;</span><span class="p">)</span>
<span class="n">specoptA</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_A.fits&#39;</span><span class="p">)</span>
<span class="n">specoptB</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">()</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">read_from_fits</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_OPT_B.fits&#39;</span><span class="p">)</span>

<span class="c1"># The optical spectra will be scaled to 1e-17 erg/s/cm^2/A</span>
<span class="n">specoptA</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
<span class="n">specoptB</span><span class="o">.</span><span class="n">convert_spectral_units</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mf">1e-17</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We could use SpecOneD’s plot function to look at the spectra individually, but in this case we want to use matplotlib to show all spectra in one plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specnir</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dispersion (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_3_0.png" src="_images/spectrum_preparation_3_0.png" />
</div>
</div>
<section id="Deredden-the-science-spectrum">
<h2>Deredden the science spectrum<a class="headerlink" href="#Deredden-the-science-spectrum" title="Permalink to this heading"></a></h2>
<p>According to the IRSA dust map (<a class="reference external" href="https://irsa.ipac.caltech.edu/applications/DUST/">https://irsa.ipac.caltech.edu/applications/DUST/</a>) the quasar J2125-1719 (21h25m40.97s -17d19m51.3s Equ J2000) has a A_V=0.1606 using the Schlafly &amp; Finkbeiner 2011 (ApJ 737, 103) Galactic dust map.</p>
<p>As we want use the dereddened magnitudes for absolute flux calibration, we deredden the three individual spectra before.</p>
<p>We demonstrate how one would use the speconed module to “deredden” the spectrum using the Fitzpatrick &amp; Massa 2007 extinction curve. To do this speconed uses the python extinction package (<a class="reference external" href="https://github.com/kbarbary/extinction">https://github.com/kbarbary/extinction</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_v</span> <span class="o">=</span> <span class="mf">0.1606</span>
<span class="n">r_v</span> <span class="o">=</span> <span class="mf">3.1</span>
<span class="n">specnir</span> <span class="o">=</span> <span class="n">specnir</span><span class="o">.</span><span class="n">remove_extinction</span><span class="p">(</span><span class="n">a_v</span><span class="p">,</span> <span class="n">r_v</span><span class="p">,</span> <span class="n">extinction_law</span><span class="o">=</span><span class="s1">&#39;fm07&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">specoptA</span> <span class="o">=</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">remove_extinction</span><span class="p">(</span><span class="n">a_v</span><span class="p">,</span> <span class="n">r_v</span><span class="p">,</span> <span class="n">extinction_law</span><span class="o">=</span><span class="s1">&#39;fm07&#39;</span><span class="p">)</span>
<span class="n">specoptB</span> <span class="o">=</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">remove_extinction</span><span class="p">(</span><span class="n">a_v</span><span class="p">,</span> <span class="n">r_v</span><span class="p">,</span> <span class="n">extinction_law</span><span class="o">=</span><span class="s1">&#39;fm07&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dereddened&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Example of Galactic dereddening the bluest spectrum&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Warning] For Fitzpatrick &amp; Massa 2007 R_V=3.1
[Warning] For Fitzpatrick &amp; Massa 2007 R_V=3.1
[Warning] For Fitzpatrick &amp; Massa 2007 R_V=3.1
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_5_1.png" src="_images/spectrum_preparation_5_1.png" />
</div>
</div>
</section>
<section id="Absolute-flux-calibration-to-broad-band-photometry">
<h2>Absolute flux calibration to broad band photometry<a class="headerlink" href="#Absolute-flux-calibration-to-broad-band-photometry" title="Permalink to this heading"></a></h2>
<p>It is evident that the flux normalization of the three spectra does not agree with another. For a first test we will now scale the spectra according to their broad band magnitudes.</p>
<section id="Absolute-flux-calibration-of-the-near-infrared-spectrum">
<h3>Absolute flux calibration of the near-infrared spectrum<a class="headerlink" href="#Absolute-flux-calibration-of-the-near-infrared-spectrum" title="Permalink to this heading"></a></h3>
<p>We will start with the near-infrared spectrum, for which 2MASS magnitudes are available. In AB the magnitudes are J=16.13, H=16.14, K=16.01. We will begin by loading the 2MASS passbands.</p>
<p>(A range of passbands are included already with the Sculptor package in sculptor/data/passbands. The PassBand class behaves very similar to the SpecOneD class, but is mainly used for calculating magnitudes from spectra. The passbands can also be plotted like SpecOneD objects, e.g. ‘pb_Ks.plot()’)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb_J</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="n">passband_name</span><span class="o">=</span><span class="s1">&#39;2MASS-J&#39;</span><span class="p">)</span>
<span class="n">pb_H</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="n">passband_name</span><span class="o">=</span><span class="s1">&#39;2MASS-H&#39;</span><span class="p">)</span>
<span class="n">pb_Ks</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="n">passband_name</span><span class="o">=</span><span class="s1">&#39;2MASS-Ks&#39;</span><span class="p">)</span>

<span class="n">pb_Ks</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_7_0.png" src="_images/spectrum_preparation_7_0.png" />
</div>
</div>
<p>As a test, let us calculate the magnitudes of the spectrum in the three 2MASS filter before flux normalization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J_ab_before</span> <span class="o">=</span> <span class="n">specnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_J</span><span class="p">)</span>
<span class="n">H_ab_before</span> <span class="o">=</span> <span class="n">specnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_H</span><span class="p">)</span>
<span class="n">Ks_ab_before</span> <span class="o">=</span> <span class="n">specnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_Ks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;J_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J_ab_before</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">H_ab_before</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ks_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Ks_ab_before</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
J_AB = 16.76
H_AB = 16.79
Ks_AB = 16.89
</pre></div></div>
</div>
<p>We choose the K-band magnitude for the flux normalization as the overlap region between the band and the spectrum is least affected by telluric features. Then we recalculate the magnitudes of the spectrum in the three 2MASS filter bands.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ks_ab</span> <span class="o">=</span> <span class="mf">16.01</span>
<span class="n">J_ab</span> <span class="o">=</span> <span class="mf">16.13</span>
<span class="n">H_ab</span> <span class="o">=</span> <span class="mf">16.14</span>
<span class="n">nspecnir</span> <span class="o">=</span> <span class="n">specnir</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">Ks_ab</span><span class="p">,</span> <span class="n">pb_Ks</span><span class="p">)</span>

<span class="n">J_ab_after</span> <span class="o">=</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_J</span><span class="p">)</span>
<span class="n">H_ab_after</span> <span class="o">=</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_H</span><span class="p">)</span>
<span class="n">Ks_ab_after</span> <span class="o">=</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">calculate_passband_ab_magnitude</span><span class="p">(</span><span class="n">pb_Ks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;J_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J_ab_after</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">H_ab_after</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ks_AB = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Ks_ab_after</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
J_AB = 15.89
H_AB = 15.92
Ks_AB = 16.01
</pre></div></div>
</div>
<p>Let us compare the magnitude differences between the J-, H-band magnitudes from before and after the normalization. The choice of the K-band is furthermore motivated by a comparison of the near-infrared with the optical spectra after all have been normalized to broad band fluxes (see below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Absolute J-band differences before and after normalization: </span><span class="si">{:.2f}</span><span class="s1"> mag vs </span><span class="si">{:.2f}</span><span class="s1"> mag&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">J_ab_before</span><span class="o">-</span><span class="n">J_ab</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">J_ab_after</span><span class="o">-</span><span class="n">J_ab</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Absolute H-band differences before and after normalization: </span><span class="si">{:.2f}</span><span class="s1"> mag vs </span><span class="si">{:.2f}</span><span class="s1"> mag&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">H_ab_before</span><span class="o">-</span><span class="n">H_ab</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H_ab_after</span><span class="o">-</span><span class="n">H_ab</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Absolute Ks-band differences before and after normalization: </span><span class="si">{:.2f}</span><span class="s1"> mag vs </span><span class="si">{:.2f}</span><span class="s1"> mag&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">Ks_ab_before</span><span class="o">-</span><span class="n">Ks_ab</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ks_ab_after</span><span class="o">-</span><span class="n">Ks_ab</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Absolute J-band differences before and after normalization: 0.63 mag vs 0.24 mag
Absolute H-band differences before and after normalization: 0.65 mag vs 0.22 mag
Absolute Ks-band differences before and after normalization: 0.88 mag vs 0.00 mag
</pre></div></div>
</div>
<p>While the K-band flux normalization leaves some residuals in the J- and H-bands, they are much closer to their 2MASS values than before.</p>
</section>
<section id="Absolute-flux-calibration-of-the-optical-spectra">
<h3>Absolute flux calibration of the optical spectra<a class="headerlink" href="#Absolute-flux-calibration-of-the-optical-spectra" title="Permalink to this heading"></a></h3>
<p>We continue with the optical spectra, starting with the green spectrum (specoptA) and use the Pan-STARRS r-band magnitude (r=16.50, AB) for normalization.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r_ab</span> <span class="o">=</span> <span class="mf">16.50</span>
<span class="n">pb_r</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="n">passband_name</span><span class="o">=</span><span class="s1">&#39;PS1-r&#39;</span><span class="p">)</span>
<span class="n">nspecoptA</span> <span class="o">=</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">r_ab</span><span class="p">,</span> <span class="n">pb_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The orange spectrum (specoptB) starts and ends at larger wavelengths. Therefore, we use the Pan-STARRS i-band magnitude (i=16.42, AB) for normalization.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i_ab</span> <span class="o">=</span> <span class="mf">16.50</span>
<span class="n">pb_i</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">PassBand</span><span class="p">(</span><span class="n">passband_name</span><span class="o">=</span><span class="s1">&#39;PS1-i&#39;</span><span class="p">)</span>
<span class="n">nspecoptB</span> <span class="o">=</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">renormalize_by_ab_magnitude</span><span class="p">(</span><span class="n">i_ab</span><span class="p">,</span> <span class="n">pb_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Flux-calibrated-spectra">
<h3>Flux calibrated spectra<a class="headerlink" href="#Flux-calibrated-spectra" title="Permalink to this heading"></a></h3>
<p>Below we display the spectra normalized by their broad band r, i, and Ks photometry. A comparison to the previous figure displays that the broad band flux normalization has been successful.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specnir</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">specoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dispersion (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specnir</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Before broad band flux normalization&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dispersion (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;After broad band flux normalization&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_20_0.png" src="_images/spectrum_preparation_20_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_20_1.png" src="_images/spectrum_preparation_20_1.png" />
</div>
</div>
</section>
</section>
<section id="Building-a-composite-spectrum">
<h2>Building a composite spectrum<a class="headerlink" href="#Building-a-composite-spectrum" title="Permalink to this heading"></a></h2>
<p>In this step we will “stitch” the spectra together using the normalized K-band spectrum as a reference. At first we renomalize the flux level of the optical spectrum B to the broad band normalized near-infrared spectrum in their overlap wavelength range 8500-9000 A.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nspecoptB</span> <span class="o">=</span> <span class="n">specoptB</span><span class="o">.</span><span class="n">renormalize_by_spectrum</span><span class="p">(</span><span class="n">nspecnir</span><span class="p">,</span> <span class="n">dispersion_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">8500</span><span class="p">,</span> <span class="mi">9000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Then we normalize the optical spectrum A to the normalized optical spectrum B in their overlap wavelength range 6000-7000 A.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nspecoptA</span> <span class="o">=</span> <span class="n">specoptA</span><span class="o">.</span><span class="n">renormalize_by_spectrum</span><span class="p">(</span><span class="n">nspecoptB</span><span class="p">,</span> <span class="n">dispersion_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">6000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Now that the spectra have the same flux level in their overlap regions, we trim their dispersion axes before we stitch them together.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nspecoptA</span> <span class="o">=</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">trim_dispersion</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6500</span><span class="p">])</span>
<span class="n">nspecoptB</span> <span class="o">=</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">trim_dispersion</span><span class="p">([</span><span class="mi">6500</span><span class="p">,</span><span class="mi">8500</span><span class="p">])</span>
<span class="n">nspecnir</span> <span class="o">=</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">trim_dispersion</span><span class="p">([</span><span class="mi">8500</span><span class="p">,</span><span class="mi">400000</span><span class="p">])</span>

<span class="c1"># Lets. plot them to have a quick look.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecoptA</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nspecoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dispersion (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[WARNING] Lower limit is below the lowest dispersion value. The lower limit is set to the minimum dispersion value.
[WARNING] Upper limit is above the highest dispersion value. The upper limit is set to the maximum dispersion value.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_26_1.png" src="_images/spectrum_preparation_26_1.png" />
</div>
</div>
<p>This doesn’t look too bad. Now we build the composite spectrum by appending all dispersion, flux density, and flux density error arrays. This is done manually. Possibly, future versions of Sculptor may be able to automatize this process.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Building the dispersion array</span>
<span class="n">comp_dispersion</span> <span class="o">=</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">dispersion</span>
<span class="n">comp_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_dispersion</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">dispersion</span><span class="p">)</span>
<span class="n">comp_dispersion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_dispersion</span><span class="p">,</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion</span><span class="p">)</span>



<span class="c1"># Building the flux density array</span>
<span class="n">comp_fluxden</span> <span class="o">=</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">fluxden</span>
<span class="n">comp_fluxden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_fluxden</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">fluxden</span><span class="p">)</span>
<span class="n">comp_fluxden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_fluxden</span><span class="p">,</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden</span><span class="p">)</span>

<span class="c1"># Building the flux density error array</span>
<span class="n">comp_fluxden_err</span> <span class="o">=</span> <span class="n">nspecoptA</span><span class="o">.</span><span class="n">fluxden_err</span>
<span class="n">comp_fluxden_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_fluxden_err</span><span class="p">,</span> <span class="n">nspecoptB</span><span class="o">.</span><span class="n">fluxden_err</span><span class="p">)</span>
<span class="n">comp_fluxden_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_fluxden_err</span><span class="p">,</span> <span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden_err</span><span class="p">)</span>

<span class="c1"># Initialize a new SpecOneD object for the composite</span>
<span class="n">composite</span> <span class="o">=</span> <span class="n">sod</span><span class="o">.</span><span class="n">SpecOneD</span><span class="p">(</span><span class="n">dispersion</span><span class="o">=</span><span class="n">comp_dispersion</span><span class="p">,</span>
                        <span class="n">fluxden</span><span class="o">=</span><span class="n">comp_fluxden</span><span class="p">,</span>
                        <span class="n">fluxden_err</span><span class="o">=</span><span class="n">comp_fluxden_err</span><span class="p">,</span>
                         <span class="c1"># We now need to specify the physical units</span>
                         <span class="c1"># of the dispersion and flux density axis.</span>
                         <span class="c1"># Here, we simply copy them from the near-infrared</span>
                         <span class="c1"># spectrum.</span>
                        <span class="n">dispersion_unit</span><span class="o">=</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">dispersion_unit</span><span class="p">,</span>
                        <span class="n">fluxden_unit</span><span class="o">=</span><span class="n">nspecnir</span><span class="o">.</span><span class="n">fluxden_unit</span><span class="p">)</span>

<span class="c1"># Let&#39;s plot our new composite spectrum</span>
<span class="n">composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_fluxden_err</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/spectrum_preparation_28_0.png" src="_images/spectrum_preparation_28_0.png" />
</div>
</div>
</section>
<section id="Saving-the-final-composite-spectrum">
<h2>Saving the final composite spectrum<a class="headerlink" href="#Saving-the-final-composite-spectrum" title="Permalink to this heading"></a></h2>
<p>As the final step of this example we save the dereddened composite spectrum to a SpecOneD hdf5 file for use with Sculptor. The relative path below will save it in the example spectra within the sculptor data folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save a version of the spectrum in the example spectra folder</span>
<span class="n">composite</span><span class="o">.</span><span class="n">save_to_hdf</span><span class="p">(</span><span class="s1">&#39;../../sculptor/data/example_spectra/J2125-1719_composite.hdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="speconed_demonstration.html" class="btn btn-neutral float-left" title="An introduction to the SpecOneD class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scripting_sculptor_1.html" class="btn btn-neutral float-right" title="Scripting Sculptor 01 - Modelling the example spectrum in a script" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jan-Torge Schindler.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>